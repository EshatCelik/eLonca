<div class="user-edit-page">
  <!-- Yükleme Durumu -->
  @if (isLoading) {
    <div class="loading-container">
      <div class="loading-spinner">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
      </div>
      <p class="loading-text">Kullanıcı bilgileri yükleniyor...</p>
    </div>
  }

  <!-- Hata Mesajı -->
  @if (errorMessage) {
    <div class="error-container">
      <div class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        <span>{{ errorMessage }}</span>
      </div>
    </div>
  }

  <!-- Ana İçerik -->
  @if (!isLoading && !errorMessage && user) {
    <div class="edit-container">
      <!-- Başlık -->
      <div class="page-header">
        <div class="header-content">
          <div class="header-icon">
            <i class="fas fa-user-edit"></i>
          </div>
          <div>
            <h1>Kullanıcı Düzenle</h1>
            <p>{{ user.name }} {{ user.lastName || '' }} kullanıcısının bilgilerini güncelleyin</p>
          </div>
        </div>
        <button class="close-btn" (click)="onClose()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <!-- Form -->
      <div class="edit-form">
        <div class="form-grid">
          <!-- Adı -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-user"></i>
              <span>Adı</span>
            </label>
            <input type="text" [(ngModel)]="user.name" class="form-input" placeholder="Adını girin">
          </div>

          <!-- Soyadı -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-user-tag"></i>
              <span>Soyadı</span>
            </label>
            <input type="text" [(ngModel)]="user.lastName" class="form-input" placeholder="Soyadını girin">
          </div>

          <!-- Kullanıcı Adı -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-id-card"></i>
              <span>Kullanıcı Adı</span>
            </label>
            <input type="text" [(ngModel)]="user.userName" class="form-input" placeholder="Kullanıcı adını girin">
          </div>

          <!-- E-posta -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-envelope"></i>
              <span>E-posta</span>
            </label>
            <input type="email" [(ngModel)]="user.email" class="form-input" placeholder="ornek@email.com">
          </div>

          <!-- Telefon -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-phone"></i>
              <span>Telefon</span>
            </label>
            <input type="text" [(ngModel)]="user.phoneNumber" class="form-input" placeholder="0555 123 45 67">
          </div>

          <!-- Rol -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-shield-alt"></i>
              <span>Rol</span>
            </label>
            <select [(ngModel)]="user.userRole" class="form-input">
              <option value="0">Admin</option>
              <option value="1">Kullanıcı</option>
              <option value="2">Yönetici</option>
            </select>
          </div>

          <!-- Durum -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-toggle-on"></i>
              <span>Durum</span>
            </label>
            <select [(ngModel)]="user.isActive" class="form-input">
              <option [ngValue]="true">Aktif</option>
              <option [ngValue]="false">Pasif</option>
            </select>
          </div>

          <!-- Mağaza -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-store"></i>
              <span>Mağaza</span>
            </label>
            <select [(ngModel)]="user.storeId" class="form-input">
              <option value="">Mağaza seçin</option>
              @for (store of stores; track store.id) {
                <option [value]="store.id">{{ store.name }}</option>
              }
            </select>
          </div>
        </div>

        <!-- Form İşlemleri -->
        <div class="form-actions">
          <button class="btn btn-secondary" (click)="onClose()" [disabled]="isSaving">
            <i class="fas fa-times"></i>
            <span>İptal</span>
          </button>
          <button class="btn btn-primary" (click)="onUpdate()" [disabled]="isSaving">
            @if (isSaving) {
              <i class="fas fa-spinner fa-spin"></i>
              <span>Kaydediliyor...</span>
            } @else {
              <i class="fas fa-save"></i>
              <span>Kaydet</span>
            }
          </button>
        </div>
      </div>
    </div>
  }
</div>
