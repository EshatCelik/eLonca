<div class="list-detail-container" *ngIf="list; else loadingTemplate">
  <!-- Modern Header -->
  <div class="modern-header">
    <div class="header-content">
      <div class="header-left">
        <button class="back-btn" (click)="onBack()">
          <i class="fas fa-arrow-left"></i>
        </button>
        <div class="header-info">
          <h1 class="list-title">{{ list?.name }}</h1>
          <div class="header-meta">
            <span class="meta-item">
              <i class="fas fa-calendar-alt"></i>
              {{ list?.createdAt | date:'dd.MM.yyyy HH:mm' }}
            </span>
            <span class="meta-item">
              <i class="fas fa-box"></i>
              {{ list?.items?.length || 0 }} ürün
            </span>
            <span class="status-badge" [ngClass]="list?.isActive ? 'status-active' : 'status-inactive'">
              <i [class]="list?.isActive ? 'fas fa-check-circle' : 'fas fa-times-circle'"></i>
              {{ list?.isActive ? 'Aktif' : 'Pasif' }}
            </span>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="action-btn edit-btn" (click)="onEdit()">
          <i class="fas fa-edit"></i>
          <span>Düzenle</span>
        </button>
        <button class="action-btn delete-btn" (click)="onDelete()" [disabled]="isDeleting">
          <i *ngIf="!isDeleting" class="fas fa-trash-alt"></i>
          <span *ngIf="isDeleting" class="spinner-border spinner-border-sm"></span>
          <span>{{ isDeleting ? 'Siliniyor...' : 'Sil' }}</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">

    <!-- Items Card -->
    <div class="items-card">
      <div class="items-header">
        <div class="items-title">
          <div class="items-icon">
            <i class="fas fa-list"></i>
          </div>
          <h3>Listedeki Ürünler</h3>
        </div>
        <button class="add-item-btn" (click)="showAddItemDialog()">
          <i class="fas fa-plus"></i>
          <span>Ürün Ekle</span>
        </button>
      </div>
      <div class="items-body">
        <div *ngIf="list?.items?.length > 0; else emptyItems" class="items-table">
          <div class="table-header">
            <div class="header-cell">Ürün</div>  
            <div class="header-cell ">Birim Fiyat</div> 
            <div class="header-cell  ">İşlemler</div>
          </div>
          <div class="table-body">
            <div *ngFor="let item of list.items; trackBy: trackByItemId" class="table-row">
              <div class="table-cell">
                <div class="product-info">
                  <div class="product-avatar">
                    <i class="fas fa-box"></i>
                  </div>
                  <div class="product-details">
                    <div class="product-name">{{ item.productName }}</div>
                  </div>
                </div>
              </div>  
              <div class="table-cell  ">
                <div class="price">{{ item.price | currency:'TRY':'symbol':'1.2-2' }}</div>
              </div>
              <div class="table-cell ">
                <div class="total-price">{{ (item.price * item.quantity) | currency:'TRY':'symbol':'1.2-2' }}</div>
              </div>
              <div class="table-cell ">
                <div class="item-actions">
                  <button class="item-action-btn edit" title="Düzenle">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="item-action-btn delete" title="Sil">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Loading Template -->
<ng-template #loadingTemplate>
  <div class="loading-container">
    <div class="loading-content">
      <div class="loading-spinner">
        <div class="spinner"></div>
      </div>
      <p class="loading-text">Yükleniyor...</p>
    </div>
  </div>
</ng-template>

<!-- Empty Items Template -->
<ng-template #emptyItems>
  <div class="empty-state">
    <div class="empty-icon">
      <i class="fas fa-box-open"></i>
    </div>
    <h3 class="empty-title">Henüz Ürün Yok</h3>
    <p class="empty-description">Bu listede henüz ürün bulunmuyor</p>
    <button class="add-first-item-btn" (click)="showAddItemDialog()">
      <i class="fas fa-plus"></i>
      <span>İlk Ürünü Ekle</span>
    </button>
  </div>
</ng-template>

<!-- Add Item Modal -->
<div class="modal-overlay" *ngIf="showAddItemModal" (click)="hideAddItemDialog()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">Yeni Ürün Ekle</h3>
      <button class="modal-close" (click)="hideAddItemDialog()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <form class="add-item-form">
        <div class="form-group">
          <label for="productName">Ürün Adı *</label>
          <input 
            type="text" 
            id="productName" 
            class="form-control" 
            [(ngModel)]="newItem.ProductName" 
            name="productName"
            placeholder="Ürün adını giriniz"
            required>
        </div>
        <div class="form-group">
          <label for="price">Birim Fiyat *</label>
          <input 
            type="number" 
            id="price" 
            class="form-control" 
            [(ngModel)]="newItem.Price" 
            name="price"
            placeholder="0.00"
            step="0.01"
            min="0"
            required>
        </div>
        <div class="form-group">
          <label for="discount">İndirim (%)</label>
          <input 
            type="number" 
            id="discount" 
            class="form-control" 
            [(ngModel)]="newItem.Discount" 
            name="discount"
            placeholder="0"
            step="0.01"
            min="0">
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="hideAddItemDialog()">
        <i class="fas fa-times me-2"></i>İptal
      </button>
      <button class="btn btn-primary" (click)="createListItem()" [disabled]="isCreatingItem">
        <span *ngIf="!isCreatingItem">
          <i class="fas fa-plus me-2"></i>Ürün Ekle
        </span>
        <span *ngIf="isCreatingItem">
          <span class="spinner-border spinner-border-sm me-2"></span>
          Ekleniyor...
        </span>
      </button>
    </div>
  </div>
</div>
